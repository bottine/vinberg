using LinearAlgebra

function ⊕(M1,M2)
    
    n1 = size(M1)[1]
    n2 = size(M2)[1]
    @assert size(M1) == (n1,n1)
    @assert size(M2) == (n2,n2)
    @assert M1' == M1
    @assert M2' == M2

    P = zeros(Int,n1+n2,n1+n2)
    P[1:n1,1:n1] = M1
    P[n1+1:end,n1+1:end] = M2

    return P
end

U = [0 1; 1 0]
A_(n) = Matrix(SymTridiagonal([2 for i in 1:n], [1 for i in 1:n-1]))

I_ = I(1)

# Using Vinberg's L(n) naming convention

Vin07_L1 = 4*U ⊕ 2*I_  ⊕ 2*I_
Vin07_L2 = 2*U ⊕ 2*I_  ⊕ 2*I_
Vin07_L3 = 1*U ⊕ 2*I_  ⊕ 2*I_
Vin07_L4 = 3*U ⊕ 2*I_  ⊕ 2*I_
Vin07_L5 = (-4)*I_ ⊕ A_(3)
Vin07_L6 = U ⊕ 2*I_  ⊕ 8*I_

Vin07_L15 = U ⊕ [2 1;1 10]
Vin07_L16 = U ⊕ [2 1;1 4] 
Vin07_L17 = U ⊕ [2 1;1 14] 
Vin07_L18 = U ⊕ [2 0;0 4] 
Vin07_L19 = -8*I_ ⊕ A_(3)

# From B&P

BP18_12 = U ⊕ 36*I_ ⊕ 6*I_



G0 = [-1 0 0 0;
       0 1 0 0;
       0 0 1 0;
       0 0 0 1;
     ]

G1= [-10 0  0 0; 
      0  2  -1 0; 
      0 -1  2 0; 
      0  0   0 1]
G2 = [-7 0   0 0; 
      0 2 -1 0; 
      0 -1 2 -1; 
      0 0 -1 2]

Sasha_1a = [2 -1 0 0; -1 2 -1 0; 0 -1 2 0; 0 0 0 -1]
Sasha_1b = [2 -1 0 0; -1 2 -1 0; 0 -1 2 0; 0 0 0 -2]
Sasha_1c = [2 -1 0 0; -1 2 -1 0; 0 -1 2 0; 0 0 0 -10]

Sasha_2 = [0 1 0 0; 1 0 0 0; 0 0 36 0; 0 0 0 6]

Sasha_3 = [-5 0 0 0; 0 1 0 0; 0 0 2 -1; 0 0 -1 2]

Gug_diagos = [
    (1, [-3, 1, 1, 1], 4),
    (2, [-1, 1, 1, 1], 4),
    (4, [-1, 1, 1, 2], 5),
    (11, [-1, 1, 1, 5], 6),
    (12, [-1, 1, 2, 3], 6),
    (13, [-1, 1, 1, 6], 6),
    (14, [-1, 1, 1, 7], 8),
    (16, [-1, 1, 3, 3], 5),
    (18, [-1, 1, 2, 5], 9),
    (19, [-1, 1, 1, 10], 7),
    (20, [-11, 1, 1, 1], 7),
    (22, [-1, 1, 1, 14], 9),
    (23, [-1, 1, 1, 15], 10),
    (25, [-1, 1, 1, 17], 13),
    (26, [-1, 1, 3, 6], 8),
    (29, [-21, 1, 1, 1], 8),
    (30, [-1, 1, 3, 7], 11),
    (31, [-1, 1, 5, 5], 6),
    (32, [-1, 1, 2, 15], 11),
    (33, [-1, 1, 1, 30], 14),
    (34, [-1, 1, 5, 6], 13),
    (35, [-1, 1, 3, 10], 14),
    (37, [-35, 1, 1, 1], 11),
    (39, [-1, 1, 6, 7], 18),
    (40, [-1, 1, 3, 14], 18),
    (41, [-1, 1, 3, 15], 15),
    (42, [-1, 1, 7, 7], 9),
    (43, [-1, 1, 5, 10], 13),
    (45, [-1, 1, 6, 15], 20),
    (46, [-1, 1, 3, 30], 20),
    (49, [-1, 1, 15, 15], 18)
]



Lattice_table= [
    # Name, Matrix, negative vector, resulting roots
    (
        "G0",
        G0,
        [1,0,0,0],
        [[0, -1, 1, 0], [0, 0, -1, 1], [0, 0, 0, -1], [1, 1, 1, 1]],
        2000
    ), 
    (
        "G1",
        G1,
        [1,0,0,0],
        [[0, -1, 1, 0], [0, 0, -1, 0], [0, 0, 0, -1], [2, 5, 5, 0], [1, 2, 2, 2], [3, 0, 0, 10], [1, 1, 1, 3], [3, 8, 4, 0], [2, 5, 3, 2], [6, 10, 5, 15], [9, 20, 10, 15]],
        2000
    ), 
    (
        "Sasha_1a",
        Sasha_1a,
        [0,0,0,1],
        [[-1, 0, 1, 0], [0, -1, 0, 0], [0, 0, -1, 0], [1, 1, 1, 1]],
        2000
    ),
    (
        "Sasha_1b",
        Sasha_1b,
        [0,0,0,1],
        [[-1, 0, 1, 0], [0, -1, 0, 0], [0, 0, -1, 0], [1, 2, 1, 1], [3, 2, 1, 2]],
        20000
    ),
    (
        "Sasha_1c",
        Sasha_1c,
        [0,0,0,1],
        [[-1, 0, 1, 0], [0, -1, 0, 0], [0, 0, -1, 0], [5, 5, 5, 2], [3, 2, 1, 1], [5, 10, 5, 3], [5, 6, 3, 2]],
        20000
    ), 
    (
        "Sasha_2",
        Sasha_2,
        [-1,1,0,0],
        [[-1, -1, 0, 0], [0, 0, -1, 0], [0, 0, 0, -1], [0, 3, 0, 1], [0, 18, 1, 0], [-3, 6, 1, 1], [-4, 4, 1, 0], [-2, 8, 1, 0], [-8, 8, 1, 4], [-2, 10, 1, 1], [-12, 12, 2, 5], [-36, 36, 7, 12], [-16, 22, 3, 8], [-54, 72, 11, 24], [-14, 22, 3, 7]],
        20000
    ),
    (
        "Sasha_3",
        Sasha_3,
        [1,0,0,0],
        [[0, -1, 0, 0], [0, 0, -1, 1], [0, 0, 0, -1], [1, 1, 2, 1], [2, 5, 0, 0], [1, 2, 1, 1], [3, 0, 5, 5]],
        20000
    ),
    (
        "BP18_12",
        BP18_12,
        [-1,1,0,0],
        [[-1, -1, 0, 0], [0, 0, -1, 0], [0, 0, 0, -1], [0, 3, 0, 1], [0, 18, 1, 0], [-3, 6, 1, 1], [-4, 4, 1, 0], [-2, 8, 1, 0], [-8, 8, 1, 4], [-2, 10, 1, 1], [-12, 12, 2, 5], [-36, 36, 7, 12], [-16, 22, 3, 8], [-54, 72, 11, 24], [-14, 22, 3, 7]],
        20000
    ),
    (
        "Vin07_L15",
        Vin07_L15,
        [-1,1,0,0],
        [[-1, -1, 0, 0], [0, 0, -1, 0], [0, 0, -1, 2], [0, 1, 1, 0], [-2, 2, 1, -1], [0, 19, 1, -2], [-1, 4, 1, -1]],
        200000
    ),


]





